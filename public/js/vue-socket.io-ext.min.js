!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).VueSocketIOExt=t()}(this,function(){"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function r(e){return function(e){if(Array.isArray(e))return e}(e)||i(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||i(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}var c=function(e){return"function"==typeof e},a=function(e){return e&&e.length<=1?e[0]:e},s=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce(function(e,t){return t(e)},e)}},u=function(e){return function(t){return e+t}},f=function(e,t,n){var r=e[t];e[t]=function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];r.call.apply(r,[e].concat(o)),n.apply(void 0,o)}},l=new(function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.listeners=new Map}var n,r,o;return n=t,(r=[{key:"addListener",value:function(e,t,n){c(t)&&(this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push({callback:t,vm:n}))}},{key:"removeListener",value:function(e,t,n){if(c(t)){var r=(this.listeners.get(e)||[]).filter(function(e){return e.callback!==t||e.vm!==n});r.length>0?this.listeners.set(e,r):this.listeners.delete(e)}}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];(this.listeners.get(e)||[]).forEach(function(e){var t;(t=e.callback).call.apply(t,[e.vm].concat(n))})}}])&&e(n.prototype,r),o&&e(n,o),t}()),p=function(e){return Object.keys(e._mutations)},y=function(e){return Object.keys(e._actions)},v=function(e){return e.split("/").pop()},h=Object.freeze({actionPrefix:"socket_",mutationPrefix:"SOCKET_",eventToMutationTransformer:function(e){return e.toUpperCase()},eventToActionTransformer:function(e,t){t=Object.assign({pascalCase:!1},t);var n=function(e){return t.pascalCase?e.charAt(0).toUpperCase()+e.slice(1):e};return 0===(e=Array.isArray(e)?e.map(function(e){return e.trim()}).filter(function(e){return e.length}).join("-"):e.trim()).length?"":1===e.length?t.pascalCase?e.toUpperCase():e.toLowerCase():/^[a-z\d]+$/.test(e)?n(e):(e!==e.toLowerCase()&&(e=function(e){for(var t=!1,n=!1,r=!1,o=0;o<e.length;o++){var i=e[o];t&&/[a-zA-Z]/.test(i)&&i.toUpperCase()===i?(e=e.slice(0,o)+"-"+e.slice(o),t=!1,r=n,n=!0,o++):n&&r&&/[a-zA-Z]/.test(i)&&i.toLowerCase()===i?(e=e.slice(0,o-1)+"-"+e.slice(o-1),r=n,n=!1,t=!0):(t=i.toLowerCase()===i,r=n,n=i.toUpperCase()===i)}return e}(e)),n(e=e.replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,function(e,t){return t.toUpperCase()})))}}),m=["connect","error","disconnect","reconnect","reconnect_attempt","reconnecting","reconnect_error","reconnect_failed","connect_error","connect_timeout","connecting","ping","pong"],d=function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=i.store,d=n(i,["store"]),b=function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),o.forEach(function(n){t(e,n,r[n])})}return e}({},h,d),g=s(b.eventToActionTransformer,u(b.actionPrefix)),w=s(b.eventToMutationTransformer,u(b.mutationPrefix));function O(e,t){if(c){var n=w(e),r=g(e),o=p(c),i=y(c),s=a(t);o.filter(function(e){return v(e)===n}).forEach(function(e){return c.commit(e,s)}),i.filter(function(e){return v(e)===r}).forEach(function(e){return c.dispatch(e,s)})}}f(e,"onevent",function(e){var t=r(e.data),n=t[0],i=t.slice(1);l.emit.apply(l,[n].concat(o(i))),O(n,i)}),m.forEach(function(t){e.on(t,function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];l.emit.apply(l,[t].concat(n)),O(t,n)})})};var b,g="undefined"!=typeof Proxy&&("function"==typeof(b=Proxy)&&/native code/.test(b.toString()));return{install:function(e,t,n){if(!((r=t)&&c(r.on)&&c(r.emit)))throw new Error("[vue-socket.io-ext] you have to pass `socket.io-client` instance to the plugin");var r;d(t,n),e.prototype.$socket=t,e.mixin(function(e){return{created:function(){var t=this,n=this.$options.sockets,r=void 0===n?{}:n;Object.keys(r).forEach(function(n){e.addListener(n,r[n],t)}),g&&(this.$options.sockets=new Proxy(r,{set:function(n,r,o){return e.addListener(r,o,t),n[r]=o,!0},deleteProperty:function(n,r){return e.removeListener(r,t.$options.sockets[r],t),delete n.key,!0}}))},beforeDestroy:function(){var t=this,n=this.$options.sockets,r=void 0===n?{}:n;Object.keys(r).forEach(function(n){g||e.removeListener(n,r[n],t),delete t.$options.sockets[n]})}}}(l));var o=e.config.optionMergeStrategies;o.sockets=o.methods},defaults:h}});
